<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Careers - Jayasan Infoware Pvt. Ltd.</title>
<link rel="stylesheet" href="styles.css">

<!-- ‚úÖ EmailJS -->
<script src="https://cdn.jsdelivr.net/npm/@emailjs/browser@4/dist/email.min.js"></script>
</head>

<body>

<!-- HEADER -->
<header>
  <div class="brand" aria-label="Jayasan brand">
    <div class="logo-wrap">
      <img src="jayasanlogo2021-removebg-preview.png" alt="Jayasan logo" />
    </div>
    <p class="iso-text">An ISO Certified Company</p>
    <p class="iso-text">9000 20000-1 27000-1</p>
  </div>

  <!-- Desktop nav -->
  <nav class="desktop" aria-label="Main navigation">
    <a href="index.html">Home</a>
    <a href="#about">About</a>
    <a href="#services">Services</a>
    <a href="#clients">Clients</a>
    <a href="#map">Presence</a>
    <a href="#contact">Contact</a>
  </nav>

  <!-- Menu toggle -->
  <div class="menu-toggle">
    <button class="hambutton" id="hambtn" aria-label="Open menu" title="Menu">
      <svg width="22" height="22" viewBox="0 0 24 24" fill="none" aria-hidden>
        <path d="M4 7h16M4 12h16M4 17h16" stroke="white" stroke-width="1.6" stroke-linecap="round"/>
      </svg>
    </button>
  </div>

  <!-- Mobile dropdown -->
  <div class="mobile-menu" id="mobileMenu" role="menu" aria-hidden="true">
    <a href="index.html">Home</a>
    <a href="#about">About</a>
    <a href="#services">Services</a>
    <a href="#clients">Clients</a>
    <a href="#map">Presence</a>
    <a href="#contact">Contact</a>
  </div>
</header>

<!-- CAREER FORM SECTION -->
<section class="form-section">
  <h2>Join Our Team</h2>

  <form id="jobForm">
    <label>Full Name*</label>
    <input type="text" name="user_name" required placeholder="Enter your full name" />

    <label>Email Address*</label>
    <input type="email" name="user_email" required placeholder="Enter your email" />

    <label>Phone Number*</label>
    <input type="tel" name="user_number" required placeholder="Enter your phone number" />

    <label>Position Applying For*</label>
    <select name="position" required>
      <option value="">Select a role</option>
      <option value="Help Desk">Help Desk</option>
      <option value="Network Engineer">Network Engineer</option>
      <option value="IT Support Engineer">IT Support Engineer</option>
      <option value="Printer Engineer">Printer Engineer</option>
    </select>

    <label>Upload Resume (PDF only)*</label>
    <input type="file" id="resumeFile" accept="application/pdf" required />

    <button class="cta" type="submit">Send Application</button>
  </form>

  <p id="successMsg" style="display:none; color:green; margin-top:10px;">
    ‚úÖ Your application has been submitted successfully. We‚Äôll get back to you soon!
  </p>
</section>

<!-- FOOTER -->
<footer id="contact" aria-label="Contact and footer">
  <img src="An_ISOIEC_Certified_Company-removebg-preview.png" alt="#" class="footer-img">
  <p><strong>Jayasan Infoware Private Limited</strong> ‚Äî Dehradun, Uttarakhand</p>
  <p>üìß <a href="mailto:info@jayasaninfoware.com" style="color:#a7c4ff">info@jayasaninfoware.com</a> &nbsp; | &nbsp; üìû +91-XXXXXXXXXX</p>
  <p>&copy; <span id="year2"></span> Jayasan Infoware Pvt. Ltd. ‚Äî All Rights Reserved</p>
</footer>

<!-- ‚úÖ JS SCRIPT -->
<script>
document.addEventListener("DOMContentLoaded", function() {
  emailjs.init("B9cRp5FtdvX1_JkvJ"); // ‚úÖ your EmailJS public key

  // ‚úÖ replace with your new Apps Script URL after deploying
  const UPLOAD_URL = "https://script.google.com/macros/s/AKfycbz5NcM58uxZaY56Fvhmvn6KPxGdzm05tVz5dJc2lSi4uuBros5xzweCY_TK3GcOeYpB2Q/exec";

  const form = document.getElementById("jobForm");
  const resumeFile = document.getElementById("resumeFile");
  const successMsg = document.getElementById("successMsg");
  const sendBtn = form.querySelector("button");

  // ‚úÖ Upload directly to Google Drive (no FileReader)
  async function uploadFileToDrive(file) {
    const formData = new FormData();
    formData.append("file", file, file.name);

    const response = await fetch(UPLOAD_URL, {
      method: "POST",
      body: formData
    });

    const result = await response.json();
    if (!result.success) throw new Error(result.error || "Upload failed");

    return result;
  }

  // ‚úÖ Handle form submission
  form.addEventListener("submit", async (e) => {
    e.preventDefault();
    sendBtn.textContent = "Uploading...";
    sendBtn.disabled = true;

    const file = resumeFile.files[0];
    if (!file) {
      alert("Please attach your resume first.");
      sendBtn.textContent = "Send Application";
      sendBtn.disabled = false;
      return;
    }

    try {
      // Step 1 ‚Äî Upload to Google Drive
      const uploadResult = await uploadFileToDrive(file);
      console.log("‚úÖ Uploaded to Drive:", uploadResult.fileUrl);

      // Step 2 ‚Äî Send email with Drive link
      sendBtn.textContent = "Sending...";

      const emailData = {
        user_name: form.user_name.value,
        user_email: form.user_email.value,
        user_number: form.user_number.value,
        position: form.position.value,
        resume_link: uploadResult.fileUrl,
      };

      await emailjs.send("service_fb7aklu", "template_1tvlztd", emailData);

      // Step 3 ‚Äî Success message
      successMsg.style.display = "block";
      form.reset();
      sendBtn.textContent = "Send Application";
      sendBtn.disabled = false;

    } catch (err) {
      alert("‚ùå Error: " + err.message);
      console.error(err);
      sendBtn.textContent = "Send Application";
      sendBtn.disabled = false;
    }
  });
});
</script>

</body>
</html>
